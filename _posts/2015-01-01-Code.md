---
layout: post
title:  "Python sizing"
tags: [opinion, research]
excerpt_separator: <!--more-->
---

Testing only
<!--more-->

<div class="language-python highlighter-rouge">
    <div class="highlight">
        <pre class="highlight">
  <code>
from pytorch_pretrained_bert import BertForSequenceClassification

def load_model(model_dir: str, num_labels: int):
    model = BertForSequenceClassification.from_pretrained(
        model_dir,
        num_labels=num_labels
    )
    model.eval()
    return model
  </code>
</pre>
</div></div>

```python
from pytorch_pretrained_bert import BertForSequenceClassification

def load_model(model_dir: str, num_labels: int):
    model = BertForSequenceClassification.from_pretrained(
        model_dir,
        num_labels=num_labels
    )
    model.eval()
    return model
```

And here is some text in between.
```python
@app.route("/predict/", methods=['POST'])
async def predict(request):
    text = request.json["text"]
    # Run some validations or do other checks
    label, probability = await model_predict(text)
    return response.json(
        {
            "label": label,
            "probability": probability,
            # And some other fields
        },
        status=200
    )
```

The end!