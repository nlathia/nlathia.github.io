<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Unexpected results in online controlled experiments | Neal Lathia</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Unexpected results in online controlled experiments" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="“Getting numbers is easy, getting numbers you can trust is quite difficult.”" />
<meta property="og:description" content="“Getting numbers is easy, getting numbers you can trust is quite difficult.”" />
<link rel="canonical" href="http://0.0.0.0:4000/paper/2017/01/09/Unexpected-Results-in-Online-Controlled-Experiments.html" />
<meta property="og:url" content="http://0.0.0.0:4000/paper/2017/01/09/Unexpected-Results-in-Online-Controlled-Experiments.html" />
<meta property="og:site_name" content="Neal Lathia" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-01-09T00:00:00-06:00" />
<script type="application/ld+json">
{"description":"“Getting numbers is easy, getting numbers you can trust is quite difficult.”","headline":"Unexpected results in online controlled experiments","dateModified":"2017-01-09T00:00:00-06:00","datePublished":"2017-01-09T00:00:00-06:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/paper/2017/01/09/Unexpected-Results-in-Online-Controlled-Experiments.html"},"url":"http://0.0.0.0:4000/paper/2017/01/09/Unexpected-Results-in-Online-Controlled-Experiments.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="http://0.0.0.0:4000/feed.xml" title="Neal Lathia" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Unexpected results in online controlled experiments | Neal Lathia</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Unexpected results in online controlled experiments" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="“Getting numbers is easy, getting numbers you can trust is quite difficult.”" />
<meta property="og:description" content="“Getting numbers is easy, getting numbers you can trust is quite difficult.”" />
<link rel="canonical" href="http://0.0.0.0:4000/paper/2017/01/09/Unexpected-Results-in-Online-Controlled-Experiments.html" />
<meta property="og:url" content="http://0.0.0.0:4000/paper/2017/01/09/Unexpected-Results-in-Online-Controlled-Experiments.html" />
<meta property="og:site_name" content="Neal Lathia" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-01-09T00:00:00-06:00" />
<script type="application/ld+json">
{"description":"“Getting numbers is easy, getting numbers you can trust is quite difficult.”","headline":"Unexpected results in online controlled experiments","dateModified":"2017-01-09T00:00:00-06:00","datePublished":"2017-01-09T00:00:00-06:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/paper/2017/01/09/Unexpected-Results-in-Online-Controlled-Experiments.html"},"url":"http://0.0.0.0:4000/paper/2017/01/09/Unexpected-Results-in-Online-Controlled-Experiments.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="http://0.0.0.0:4000/feed.xml" title="Neal Lathia" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Neal Lathia</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/research/">Research</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Unexpected results in online controlled experiments</h1><p class="page-description">“Getting numbers is easy, getting numbers you can trust is quite difficult.”</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2017-01-09T00:00:00-06:00" itemprop="datePublished">
        Jan 9, 2017
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      4 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#paper">paper</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>While discussing some A/B tests that we are running, <a href="https://medium.com/u/e0e17553ea9f">Colin McFarland</a> recommended “Unexpected Results in Online Controlled Experiments” by Kohavi and Longbotham, from SIG KDD Explorations 2010. Following on from my other research summaries, here’s a quick overview of the paper.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>If a result seems unexpected it may be due to lack of understanding of user behavior or it could be due to a software or experimental design problem.
</code></pre></div></div>

<p>This short, well-written paper does not focus on specific ideas or experimental results, but instead covers a wide range of unexpected lessons learned across a variety of online experiments. Many of these lessons capture differences between the control (A) and treatment (B) groups that end up unduly affecting your experiment, causing you to measure a change where none should have been measured.</p>

<h2 id="system-differences">System Differences</h2>
<p>The first type of differences are “under the hood:” system differences that you may not think about when running an experiment. There were two examples where the website’s speed was unintentionally affected in one of the two groups, resulting in performance differences, another example where a monitoring system skewed the metrics, and an example where website localisation was not taken into account properly:</p>
<ol>
  <li>Often, “if the randomization function determines that the user should be in Control, the page is displayed; if the randomization shows that the user should be in Treatment, a browser redirect is done.” The redirect added loading time to the treatment: users in B had a slower experience.</li>
  <li>In another example, an experiment was run where both the control and treatment website variants made use of a cache. Since the experiment was set up as 90% (A) and 10% (B), the cache was skewed towards those users/entries that were in the control — resulting in faster performance for A.</li>
  <li>In a one-click conversion experiment, there was a surprisingly large number of page views in the treatment group. “An investigation revealed that the experimenting site had a monitoring system that requested the page and then simulated a click on the purchase button and checked the ordering pipeline” — the difference was due to the monitoring system, not the users.</li>
  <li>In practice, you want the distribution and types of users arriving into your control and treatment groups to be the same. Do your experimentation tools take into consideration how your website may be localised across users? “When a new version of the MSN US Home Page was tested in a controlled experiment […] the results were highly biased because the population of users from non-US IPs was much higher in the Treatment than in the Control.”</li>
</ol>

<h2 id="experiment-execution">Experiment Execution</h2>
<p>There were other unintended differences that seemed to originate from how the experiments were executed and measured.:</p>
<ol>
  <li>In one experiment, the percentage of users allocated to the treatment and control was ramped up over time: “since the Treatment had a much larger percentage on the last two days, the clicks per user on those days carried larger weight with the Treatment mean making the Treatment look worse than the Control.” This lead to an example of <a href="https://en.wikipedia.org/wiki/Simpson%27s_paradox">Simpson’s Paradox</a>.</li>
  <li>When evaluating email campaigns, experiments were run by sending emails to a treatment group, and withholding them from the control group. “The OEC (Overall Evaluation Criterion) for the campaigns was based on purchases whose sessions were referred by the e-mails. But under this criterion, all ideas/campaigns evaluated positively.” The effect? Users started complaining about receiving too many emails.</li>
</ol>

<h2 id="conclusion">Conclusion</h2>
<p>The main recommendation in the paper is to run A/A tests, which tests the tool(s) and methods that you use to split users across variants. An A/A result should show no significant difference (you can expect a difference 5% of the time even in A/A tests if alpha is 0.05 !), but often uncovers some: “the slightest difference could result in significant changes to the user experience.”</p>

<p>The authors also share the following take-aways:</p>
<ol>
  <li>Always get information on the ultimate action you want the user to take.</li>
  <li>Beware of classical statistical formulas that assume independence.</li>
  <li>Experimental control is critical. Keep everything constant except the thing you want to test.</li>
  <li>Drill-down by time to look at hourly data. Had the result not been so surprising (e.g., if the treatment were 2% worse), we might have accepted the result. We now regularly show hourly plots for sanity checks to detect such anomalies.</li>
  <li>Use screen scrapers to save screen shots of the pages being experimented on a regular basis in order to allow debugging of surprises. We have found this to be extremely useful in other experiments.</li>
  <li>To avoid Simpson’s Paradox, “you can simply require that the percentage of users in the Treatment relative to the Control not change during the experiment.”</li>
</ol>

<p>At Skyscanner, our internal experimentation tool (Dr Jekyll) simply forces a new allocation and new scorecard anytime the experimenter makes a change. We also force buckets to be balanced: you choose your percentage of users you want in the experiment and we split all treatments equally.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Running a good online experiment is a lot more than just randomly assigning users into two groups — it requires careful planning and vigilance in monitoring for known and yet-to-be discovered sources of experimental bias.
</code></pre></div></div>

<p>Here’s another good read about experimentation: <a href="http://codevoyagers.com/2016/03/16/design-like-youre-right-test-like-youre-wrong/">Design Like You’re Right, Test Like You’re Wrong</a>.</p>

  </div><a class="u-url" href="/paper/2017/01/09/Unexpected-Results-in-Online-Controlled-Experiments.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p></p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/nlathia" title="nlathia"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/neal_lathia" title="neal_lathia"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
