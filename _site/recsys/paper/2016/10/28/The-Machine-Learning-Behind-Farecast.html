<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>The machine learning behind farecast | Neal Lathia</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="The machine learning behind farecast" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Predicting the black box of flight prices." />
<meta property="og:description" content="Predicting the black box of flight prices." />
<link rel="canonical" href="http://0.0.0.0:4000/recsys/paper/2016/10/28/The-Machine-Learning-Behind-Farecast.html" />
<meta property="og:url" content="http://0.0.0.0:4000/recsys/paper/2016/10/28/The-Machine-Learning-Behind-Farecast.html" />
<meta property="og:site_name" content="Neal Lathia" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-10-28T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"Predicting the black box of flight prices.","headline":"The machine learning behind farecast","dateModified":"2016-10-28T00:00:00-05:00","datePublished":"2016-10-28T00:00:00-05:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/recsys/paper/2016/10/28/The-Machine-Learning-Behind-Farecast.html"},"url":"http://0.0.0.0:4000/recsys/paper/2016/10/28/The-Machine-Learning-Behind-Farecast.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="http://0.0.0.0:4000/feed.xml" title="Neal Lathia" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>The machine learning behind farecast | Neal Lathia</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="The machine learning behind farecast" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Predicting the black box of flight prices." />
<meta property="og:description" content="Predicting the black box of flight prices." />
<link rel="canonical" href="http://0.0.0.0:4000/recsys/paper/2016/10/28/The-Machine-Learning-Behind-Farecast.html" />
<meta property="og:url" content="http://0.0.0.0:4000/recsys/paper/2016/10/28/The-Machine-Learning-Behind-Farecast.html" />
<meta property="og:site_name" content="Neal Lathia" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-10-28T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"Predicting the black box of flight prices.","headline":"The machine learning behind farecast","dateModified":"2016-10-28T00:00:00-05:00","datePublished":"2016-10-28T00:00:00-05:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/recsys/paper/2016/10/28/The-Machine-Learning-Behind-Farecast.html"},"url":"http://0.0.0.0:4000/recsys/paper/2016/10/28/The-Machine-Learning-Behind-Farecast.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="http://0.0.0.0:4000/feed.xml" title="Neal Lathia" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Neal Lathia</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/research/">Research</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">The machine learning behind farecast</h1><p class="page-description">Predicting the black box of flight prices.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2016-10-28T00:00:00-05:00" itemprop="datePublished">
        Oct 28, 2016
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      4 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#recsys">recsys</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#paper">paper</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>A number of years ago, I ran into <a href="http://www.isi.edu/integration/papers/etzioni03-kdd.pdf">this research paper</a> “<em>To Buy or Not to Buy: Mining Airfare Data to Minimize Ticket Purchase Price</em>,” when I was working at UCL on a project that was researching how to help people navigate cities better using data. I had just received a large data set of Oyster card transactions from Transport for London. This paper, which looks at recommending whether to buy an airplane ticket, inspired us to apply a similar concept to help people decide what travel card to buy, with a recommender system that would learn from their travel patterns. That research resulted in <a href="http://nlathia.github.io/papers/lathia_kdd2011.pdf">this paper</a> “<em>Mining Mobility Data to Minimise Travellers’ Spending on Public Transport</em>” and this <a href="http://www.bbc.co.uk/news/uk-england-london-13389363">BBC news story</a>.</p>

<p>I resurfaced the airfare data paper for the Skyscanner reading group — we’ve been meeting to discuss research papers that tackle similar problems to those that we face within Skyscanner. Just like the last post, here’s a brief, non-technical overview of what we discussed.</p>

<h3 id="making-a-product-out-of-price-prediction">Making a Product out of Price Prediction</h3>
<p>Flight prices are notoriously subject to change: I’m sure that most of us have looked at a flight, thought about it for a while, and then come back to it only to find that its price had shot up (or, if we’re lucky, down).</p>

<p>As the authors of this paper explain, part of predicting a flight price seems to be about <em>decoding</em> the hidden decision engine that carriers use to set their own prices: perhaps a current route’s price is based on available seats, on demand, on competitor’s prices, on the time of year, or a multitude of other factors. Given that there are so many different reasons why flight prices may change (and we do not necessarily have access to all the data that providers are using to set prices), could we ever reasonably develop any means to predict flight prices?</p>

<p>This scenario is one where machine learning can come to the rescue. Using the only assumption that there will be some <em>similarity</em> between historical and future route prices, the authors create a model based only on data that is readily available to them on the web: the route (e.g., Seattle-Washington), the days until the departure (e.g., 10), and the historical prices. This model tries to answer the question: <em>given a route, a departure date, and the current price, should I buy the ticket, or should I wait?</em></p>

<p>The authors throw a number of well-known machine learning methods at the problem, such as <a href="https://en.wikipedia.org/wiki/Reinforcement_learning">reinforcement learning</a> and <a href="https://en.wikipedia.org/wiki/Time_series">time series forecasting</a>, and a <a href="https://en.wikipedia.org/wiki/Ensemble_learning">combined model</a> which (to no surprise), turns out to be the most accurate. The paper, though, does hold back on a number of fronts: it only gives us results for a small set of hand selected routes, only consider up to 21 days before a departure date (which means that 75% of their users would not be able to achieve any cheaper options), and does not consider any long-term effects like seasonality (to be fair it was before the <em>big data</em> era, hence scalability was an issue for them).</p>

<p>Even so, there are a number of key take-aways in this paper:</p>

<p><strong>Prediction Accuracy &lt; User Utility.</strong> When faced with a problem like “predicting the value of X,” we’d often be naturally inclined to measure how accurately we predict that value. Instead, these authors measure how well such a prediction could support a user action, in this case “wait” or “buy.”</p>

<p><strong>Predicting is not the same as informing.</strong> The recent announcements from Google show that they have implemented something like this in their <a href="https://blog.google/topics/travel/making-travel-planning-less-stressful-holiday-season/">flights search</a>. However, they <em>inform</em> users based on historical trends (“this fare is likely to increase” rather than “we predict this fare will be x”).</p>

<p><strong>Time ordered data does not mean a time series problem.</strong> Since the data is ordered by time, one of the ‘natural’ approaches to try was a model that predicts whether a price will go up or down based on its recent behaviour. However, the authors found that flight prices tend to jump — either up or down — and so predicting the next price based on what has happened for the last few hours was one of the worst performing approaches.</p>

<p>The authors of this paper later founded <a href="https://moz.com/blog/farecast-an-evolution-in-travel-pricing-prediction">Farecast</a>, which was eventually <a href="https://en.wikipedia.org/wiki/MSN_Travel_%28website%29">acquired by Microsoft</a>. Bing eventually dropped the Farecast’s prediction feature but other meta-search engines have developed similar products; Kayak have had a price prediction tool for more than 3 years (see their <a href="https://www.kayak.co.uk/news/kayak-launches-price-forecasts-flights/">blog post</a> announcing the feature), and Google has just launched a prediction tool in their recent <a href="https://blog.google/topics/travel/making-travel-planning-less-stressful-holiday-season/">blog post</a>.</p>

<h3 id="conclusion">Conclusion</h3>
<p>If you are interested in the technical side of this work, check out the paper, or get in touch on <a href="https://twitter.com/neal_lathia">twitter</a>.</p>

  </div><a class="u-url" href="/recsys/paper/2016/10/28/The-Machine-Learning-Behind-Farecast.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p></p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/nlathia" title="nlathia"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/neal_lathia" title="neal_lathia"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
